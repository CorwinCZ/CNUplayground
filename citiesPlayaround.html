<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Type Ahead ðŸ‘€</title>
    <!-- <link rel="stylesheet" href="style.css" /> -->
  </head>
  <body>
    <form class="search-form">
      <input
        id="inputCity"
        type="text"
        class="searchForm-input"
        placeholder="City or State"
      />
      <input style="display: none" />
      <ul id="filteredCityContainer" class="suggestions">
        <li>Filter for a city</li>
        <li>or a state</li>
      </ul>
    </form>
  </body>
  <script>
    const endpoint =
      "https://gist.githubusercontent.com/Miserlou/c5cd8364bf9b2420bb29/raw/2bf258763cdddd704f8ffd3ea9a3e81d25e2c6f6/cities.json";
    const filteredCityContainer = document.querySelector(
      "#filteredCityContainer"
    );
    const inputCity = document.querySelector("#inputCity");

    let statesAndCities = [],
      filteredStatesAndCities = [];

    // get cities data
    const data = fetch(endpoint)
      .then(response => response.json())
      .then(data => (statesAndCities = data))
      .catch(err => {
        console.log("An error occurred");
      });

    function onFilterChange(e) {
      let filter = RegExp(e.target.value, "i");

      filteredStatesAndCities = statesAndCities.filter(
        ({ city, state: cityState }) =>
          filter.test(city) || filter.test(cityState)
      );
      updateForm();
    }

    function updateForm() {
      // will udpate form when input filter change
      filteredCityContainer.innerHTML = "";

      filteredStatesAndCities.forEach(function(city, index) {
        let liText = document.createTextNode(city.city);
        let li = document.createElement("li");
        li.appendChild(liText);
        filteredCityContainer.appendChild(li);
      });
    }

    inputCity.addEventListener("keypress", onFilterChange);
  </script>
</html>
